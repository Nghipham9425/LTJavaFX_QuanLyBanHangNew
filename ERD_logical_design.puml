@startuml ERD - Logical Data Design
!theme plain

entity "üë§ User" as user {
  * id : INT <<PK>>
  --
  * username : VARCHAR(50) <<U>>
  * password : VARCHAR(255)
  * full_name : VARCHAR(100)
  * role : ENUM
  * status : BOOLEAN
}

entity "üè¢ Supplier" as supplier {
  * id : INT <<PK>>
  --
  * name : VARCHAR(100)
  phone : VARCHAR(15)
  email : VARCHAR(100)
  address : TEXT
  * status : BOOLEAN
}

entity "üìÇ Category" as category {
  * id : INT <<PK>>
  --
  * name : VARCHAR(100)
  description : TEXT
}

entity "üì¶ Product" as product {
  * id : INT <<PK>>
  --
  * name : VARCHAR(100)
  barcode : VARCHAR(50) <<U>>
  * price : DECIMAL(15,2)
  * cost_price : DECIMAL(15,2)
  * stock : INT
  * category_id : INT <<FK>>
  * supplier_id : INT <<FK>>
  * status : BOOLEAN
  * created_at : DATETIME
  * updated_at : DATETIME
}

entity "üë• Customer" as customer {
  * id : INT <<PK>>
  --
  * name : VARCHAR(100)
  phone : VARCHAR(15)
  email : VARCHAR(100)
  * points : INT
  * total_spent : DECIMAL(15,2)
  * status : BOOLEAN
  * created_at : DATETIME
  * updated_at : DATETIME
}

entity "üéØ Promotion" as promotion {
  * id : INT <<PK>>
  --
  * name : VARCHAR(100)
  * discount_type : ENUM
  * discount_value : DECIMAL(15,2)
  * start_date : DATETIME
  * end_date : DATETIME
  * status : BOOLEAN
}

entity "üõí Order" as order {
  * id : INT <<PK>>
  --
  customer_id : INT <<FK>>
  * user_id : INT <<FK>>
  promotion_id : INT <<FK>>
  * total_amount : DECIMAL(15,2)
  * discount_amount : DECIMAL(15,2)
  * final_amount : DECIMAL(15,2)
  * payment_method : ENUM
  * status : ENUM
  note : TEXT
  * created_at : DATETIME
}

entity "üìã Order Detail" as order_detail {
  * id : INT <<PK>>
  --
  * order_id : INT <<FK>>
  * product_id : INT <<FK>>
  * quantity : INT
  * price : DECIMAL(15,2)
  * discount_amount : DECIMAL(15,2)
}

entity "üìä Inventory" as inventory {
  * id : INT <<PK>>
  --
  * product_id : INT <<FK>>
  * quantity : INT
  * type : ENUM
  reference_id : INT
  reference_type : VARCHAR(50)
  note : TEXT
  * created_at : DATETIME
}

entity "‚è∞ Shift" as shift {
  * id : INT <<PK>>
  --
  * user_id : INT <<FK>>
  * start_time : DATETIME
  end_time : DATETIME
  * status : ENUM
  * created_at : DATETIME
}

' Relationships with Cardinality
customer ||--o{ order : "places\n(0..n)"
user ||--o{ order : "creates\n(1..n)"
user ||--o{ shift : "works\n(1..n)"
promotion ||--o{ order : "applied to\n(0..n)"

order ||--o{ order_detail : "contains\n(1..n)"

product ||--o{ order_detail : "included in\n(0..n)"
product }o--|| category : "belongs to\n(n..1)"
product }o--|| supplier : "supplied by\n(n..1)"
product ||--o{ inventory : "tracked in\n(1..n)"

note top of customer : "Customer can be NULL\nin orders for walk-in sales"

note bottom of order : "Payment Methods:\nCASH, VNPAY\n\nStatus Flow:\nPROCESSING ‚Üí COMPLETED\nPROCESSING ‚Üí FAILED\nPROCESSING ‚Üí CANCELLED"

note right of inventory : "Types: IN, OUT\n\nReference Types:\nSALE, PURCHASE,\nADJUSTMENT, etc."

note left of product : "Business Rules:\n‚Ä¢ price >= cost_price\n‚Ä¢ stock >= 0\n‚Ä¢ barcode is unique"

note bottom of promotion : "Discount Types:\nPERCENT, AMOUNT\n\nTime-based activation"

@enduml 